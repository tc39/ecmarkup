<!doctype html>
<meta charset="utf8">
<title>Ecmarkup</title>
<pre class=metadata>
repository: https://github.com/tc39/ecmarkup
copyright: false
</pre>
<style>
  .result {
    padding-left: 0.5em;
    border-left: 5px solid #dadada;
  }
</style>
<emu-biblio href="./biblio.json"></emu-biblio>
<emu-intro id="intro">
  <h1>Ecmarkup</h1>
  <p><a href="https://github.com/tc39/ecmarkup">Ecmarkup</a> is a number of custom elements and a toolchain suitable for specifying semantics for ECMAScript and other programming languages.</p>
  <p>Ecmarkup offers the following conveniences (among many others):</p>
  <ul>
    <li><a href="https://github.com/tc39/ecmarkdown">Ecmarkdown</a> syntax for paragraphs and algorithms</li>
    <li><a href="https://github.com/rbuckton/grammarkdown">Grammarkdown</a> for specifying grammar</li>
    <li>Terse markup for the authoring conventions used in ECMAScript specifications including clauses, notes, examples, figures, tables, and more.</li>
    <li>Easy cross-references by element ID to clauses, abstract operations, examples, figures, tables, and etc. in the current document, ES6, and other specs.</li>
    <li>Generates table of contents</li>
    <li>Generates clause ids based on document position</li>
    <li>Auto-links abstract operations and terms based on name with support for external bibliographies for cross-referencing between specs</li>
    <li>Source code syntax highlighting inside pre code blocks</li>
  </ul>
  <p>This document is itself written using Ecmarkup. Its source can be viewed <a href="https://github.com/tc39/ecmarkup/blob/HEAD/spec/index.html">on github</a>.</p>
</emu-intro>

<emu-clause id="getting-started">
  <h1>Getting Started</h1>
  <pre>npm install -g ecmarkup
ecmarkup --help
ecmarkup spec.html out.html
  </pre>
</emu-clause>
<emu-clause id="useful-options">
  <h1>Options</h1>
  <p>Build options and document options can be passed in via the command line or specified in the front-matter of your document.</p>
  <emu-table id="build-options">
    <emu-caption>Build options</emu-caption>
    <table>
      <tr><th>Option</th><th>Description</th></tr>
      <tr><td>watch</td><td>Rebuild when files change</td></tr>
      <tr><td>verbose</td><td>Print verbose logging info</td></tr>
      <tr><td>write-biblio</td><td>Emit a biblio file to the specified location</td></tr>
      <tr><td>assets</td><td>"none" for no css/js, "inline" for inline css/js</td></tr>
      <tr><td>css-out</td><td>Emit the Ecmarkup CSS file to the specified location</td></tr>
      <tr><td>js-out</td><td>Emit the Ecmarkup JS file to the specified location</td></tr>
      <tr><td>lint-spec</td><td>Enforce some style and correctness checks</td></tr>
      <tr><td>lint-formatter</td><td>The <a href="https://eslint.org/docs/user-guide/formatters/">eslint formatter</a> to be used for printing warnings and errors when using --verbose. Either the name of a built-in eslint formatter or the package name of an installed eslint compatible formatter.</td></tr>
      <tr><td>strict</td><td>Exit with an error if there are warnings. Cannot be used with --watch</td></tr>
      <tr><td>mark-effects</td><td>Whether to render <a href="#effects">effects</a> like "user code".</td></tr>
    </table>
  </emu-table>

  <emu-table id="document-options">
    <emu-caption>Document options</emu-caption>
    <table>
      <tr><th>Option</th><th>Description</th></tr>
      <tr><td>title</td><td>Title of specification, for example `ECMAScript 2016` or `Async Functions`.</td></tr>
      <tr><td>status</td><td>Status of specification. Can be `proposal`, `draft`, or `standard`. Default is `proposal`.</td></tr>
      <tr><td>stage</td><td>Stage of proposal. Must be a number if provided, but is optional. Sets `version` to `Stage N Draft`, but can be overridden.</td></tr>
      <tr><td>version</td><td>Version of specification, for example `6&lt;sup>th&lt;/sup> Edition` or `Draft 1`. Optional.</td></tr>
      <tr><td>date</td><td>Date the spec was generated. Used for various pieces of boilerplate that include dates. Defaults to the value of <a href="https://reproducible-builds.org/docs/source-date-epoch/">the SOURCE_DATE_EPOCH environment variable</a> (as a number of second since the Unix epoch) if it exists, otherwise defaults to today's date.</td></tr>
      <tr><td>shortname</td><td>Shortname of specification, for example `ECMA-262` or `ECMA-402`.</td></tr>
      <tr><td>location</td><td>URL of this specification. Use in conjunction with the biblio file to enable external specs to reference this one.</td></tr>
      <tr><td>copyright</td><td>Emit copyright and software license information. Boolean, default true.</td></tr>
      <tr><td>contributors</td><td>Contributors to this specification, ie. those who own the copyright. If your proposal includes text from any Ecma specification, you should include "Ecma International" in this list.</td></tr>
      <tr><td>toc</td><td>Emit table of contents. Boolean, default true.</td></tr>
      <tr><td>old-toc</td><td>Emit the old style of table of contents. Boolean, default false.</td></tr>
      <tr><td>load-biblio</td><td>Load the specified biblio.json file. This should contain either an object as exported by `--write-biblio` or an array of such objects.</td></tr>
    </table>
  </emu-table>
</emu-clause>

<emu-clause id="stylesheets-and-scripts">
  <h1>Stylesheets and Scripts</h1>
  <p>Ecmarkup requires css styles and, if you're using the sidebar table of contents, javascript as well. By default CSS and JS dependencies are inlined into the document. You can override this by setting assets to "none" (for example if you want to manually link to external assets). Passing cssOut and jsOut will write the respective files to disk at the given location.</p>
</emu-clause>
<emu-clause id="editorial-conventions">
  <h1>Editorial Conventions</h1>
  <p>There are a large number of features in Ecmarkup. Detailed documentation can be found in later sections. This section provides a high-level overview of what capabilities are available and when to use them.</p>

  <emu-table>
    <emu-caption>Structuring your Ecmarkup document</emu-caption>
    <table>
      <tr><th>Notational Convention</th><th>Ecmarkup Functionality</th></tr>
      <tr><td>Clauses</td><td><emu-xref href="#emu-clause" title></emu-xref>, <emu-xref href="#emu-intro" title></emu-xref>, and <emu-xref href="#emu-annex" title></emu-xref></td></tr>
      <tr><td>Algorithms</td><td><emu-xref href="#emu-alg" title></emu-xref> with Ecmarkdown (see also <emu-xref href="#emd-overview"></emu-xref>). Equations such as <a href="https://tc39.es/ecma262/#sec-year-number">Year Number</a> use <emu-xref href="#emu-eqn" title></emu-xref></td></tr>
      <tr><td>Notes</td><td><emu-xref href="#emu-note" title></emu-xref></td></tr>
      <tr><td>Figures (such as images)</td><td><emu-xref href="#emu-figure" title></emu-xref> and `emu-caption`</td></tr>
      <tr><td>Tables</td><td><emu-xref href="#emu-table" title></emu-xref> and `emu-caption`</td></tr>
      <tr><td>Examples</td><td><emu-xref href="#emu-example" title></emu-xref> and `emu-caption`</td></tr>
      <tr><td>Grammar</td><td><emu-xref href="#emu-grammar" title></emu-xref> using <a href="https://github.com/rbuckton/grammarkdown">Grammarkdown syntax</a> or <emu-xref href="#emu-production" title></emu-xref> and child elements</td></tr>
      <tr><td>Cross-references</td><td><emu-xref href="#emu-xref" title></emu-xref> (can reference clauses, productions, abstract operations, tables, figuers, and examples)</td></tr>
    </table>
  </emu-table>

  <p>There are also a number of elements and corresponding Ecmarkdown syntax to give inline styles to various parts of your document in accordance with ECMAScript conventions. More detail on Ecmarkdown syntax can be found <a href="https://github.com/tc39/ecmarkdown">on its readme</a>.</p>
  <emu-table id="emd-overview">
    <emu-caption>Inline styles/conventions</emu-caption>
    <table>
      <tr>
        <th>Notational Convention</th>
        <th>Ecmarkdown Syntax</th>
        <th>Ecmarkup Functionality</th>
      </tr>
      <tr>
        <td>Variables, such as those in defined in algorithms, parameters in abstract operations, etc.</td>
        <td>`_variable_`</td>
        <td>`&lt;var>variable&lt;/var>`</td>
      </tr>
      <tr>
        <td>ECMAScript Language Type Values, eg. *undefined*, *true*, *1*<sub>ùîΩ</sub>, *"string"*, *TypeError*, etc.</td>
        <td>`*TypeError*`</td>
        <td>`&lt;emu-val>TypeError&lt;/emu-val>`</td>
      </tr>
      <tr>
        <td>Specification types and their instances, eg. ~throw~ and ~empty~.</td>
        <td>`~throw~`</td>
        <td>`&lt;emu-const>throw&lt;emu-const>`</td>
      </tr>
      <tr>
        <td>Source Code, eg. `Function.prototype`.</td>
        <td>`\`code\``</td>
        <td>`&lt;code>code&lt;/code>`</td>
      </tr>
      <tr>
        <td>Non-terminal references, eg. as |FunctionDeclaration| and |FunctionExpression|.</td>
        <td>`|FunctionExpression|`</td>
        <td>`&lt;emu-nt>FunctionExpression&lt;/emu-nt>`</td>
      </tr>
    </table>
  </emu-table>
</emu-clause>
<emu-clause id="metadata">
  <h1>Metadata</h1>
  <p>There are a number of settings that allow customizations or enable generation of boilerplate. Metadata can be included in the document and passed on the command line, for example `--no-toc --title "Document 1"`. Metadata given on the command line takes precedence.</p>
  <p>To add metadata to your document, use yaml syntax inside a `&lt;pre class=metadata>` element somewhere in the root of your document.</p>
  <p>All of the command line options can be provided in the metadata block. See <emu-xref href="#build-options"></emu-xref> and <emu-xref href="#document-options"></emu-xref> for a list (or consult `--help`).</p>
  <h2>Example document with metadata</h2>
<pre><code class="language-html">
&lt;pre class=metadata>
Title: Document 1
toc: false
&lt;/pre>
</code></pre>
</emu-clause>
<emu-clause id="clauses">
  <h1>Clauses</h1>
  <p>Clauses are referenced using their id and are numbered automatically based on document position. Ecmarkdown syntax can be used in descendent text nodes as well. Text nodes are parsed as Ecmarkdown Fragments.</p>

  <emu-clause id="emu-intro">
    <h1>emu-intro</h1>
    <p>Non-normative introductory information.</p>

    <h2>Attributes</h2>
    <p><b>id:</b> Clause id. Must be unique.</p>
    <p><b>aoid:</b> Abstract operation ID. A unique name identifying this clause as an abstract operation. Algorithm steps will auto-link calls to this abstract operation to this clause. If left blank, the aoid will be set to the id of this clause.</p>
  </emu-clause>

  <emu-clause id="emu-clause">
    <h1>emu-clause</h1>
    <p>Normative clause.</p>

    <h2>Attributes</h2>
    <p><b>id:</b> Clause id. Must be unique.</p>
    <p><b>example:</b> If present, the clause is an example.</p>
    <p><b>legacy:</b> If present, the clause is Legacy.</p>
    <p><b>normative-optional:</b> If present, the clause is Normative Optional.</p>
    <p><b>number:</b> Optional: An explicit clause number, overriding the default auto-incrementing number. Can be a nested number, as in `number="2.1"`.</p>
    <p><b>type:</b> Optional: Type of feature described by the clause.</p>
    <ul>
      <li>"abstract operation"</li>
      <li>"concrete method"</li>
      <li>"host-defined abstract operation"</li>
      <li>"implementation-defined abstract operation"</li>
      <li>"internal method"</li>
      <li>"numeric method"</li>
      <li>"sdo" or "syntax-directed operation"</li>
    </ul>

    <emu-clause id="emu-clause-legacy-attributes" legacy>
      <h1>Legacy Attributes</h1>
      <p><b>aoid:</b> Abstract operation ID. A unique name identifying this clause as an abstract operation. Algorithm steps will auto-link calls to this abstract operation to this clause. If left blank, the aoid will be set to the id of this clause. When a structured header is present the aoid will be inferred, but this attribute may be set explicitly when not using a structured header.</p>
    </emu-clause>

    <emu-clause id="emu-clause-structured-headers">
      <h1>Structured Headers</h1>
      <p>A clause describing an operation or method may have a <dfn>structured header</dfn> to document its signature and metadata. Such a structure consists of:</p>
      <ol>
        <li>an <code>&lt;h1&gt;</code> element containing the name of the operation followed by a parenthesized list of parameters, each appearing on a comma-terminated line of its own and consisting of a name and value constraints separated by a colon and optionally preceded with "optional"</li>
        <li>
          a <code>&lt;dl&gt;</code> element with class "header" and a collection of optional key-value pairs expressed using <code>&lt;dt&gt;</code> and <code>&lt;dd&gt;</code> elements:
          <ul>
            <li><b>description:</b> An explanation of the operation's behaviour.</li>
            <li><b>effects:</b> A comma-separated list of "effects" associated with the clause and transitively with those referencing it. The only currently-known effect is "user-code", which indicates that the operation or method can evaluate non-implementation code (such as custom getter).
            <li><b>for:</b> The type of value to which a clause of type "concrete method" or "internal method" applies.</li>
            <li><b>redefinition:</b> If "true", the name of the operation will not automatically link (i.e., it will not automatically be given an aoid).</li>
          </ul>
        </li>
      </ol>
    </emu-clause>

    <h2>Example</h2>
    <h3>Element</h3>
    <pre><code class="language-html">
      &lt;emu-clause id="example-normative-optional" type="abstract operation" example normative-optional>
        &lt;h1>
          ExampleOperation (
            _S_: a String,
            optional _length_: a non-negative integer,
          )
        &lt;/h1>
        &lt;dl class="header">
          &lt;dt>description&lt;/dt>
          &lt;dd>It returns a List of the code points of the first _length_ grapheme clusters of _S_ using the host environment's current locale, or all code points when _length_ is not present.&lt;/dd>
        &lt;/dl>
        &lt;p>This clause is normative optional.&lt;/p>
      &lt;/emu-clause>
    </code></pre>
    <h3>Result</h3>
    <emu-clause id="example-normative-optional" type="abstract operation" example normative-optional>
      <h1>
        ExampleOperation (
          _S_: a String,
          optional _length_: a non-negative integer,
        )
      </h1>
      <dl class="header">
        <dt>description</dt>
        <dd>It returns a List of the code points of the first _length_ grapheme clusters of _S_ using the host environment's current locale, or all code points when _length_ is not present.</dd>
      </dl>
      <p>This clause is normative optional.</p>
    </emu-clause>
  </emu-clause>

  <emu-clause id="emu-annex">
    <h1>emu-annex</h1>
    <p>Annex clause.</p>

    <h2>Attributes</h2>
    <p><b>normative:</b> If present, annex is normative. Default is non-normative.</p>
    <p><b>id:</b> Clause id. Must be unique.</p>
    <p><b>aoid:</b> Abstract operation ID. A unique name identifying this clause as an abstract operation. Algorithm steps will auto-link calls to this abstract operation to this clause. If left blank, the aoid will be set to the id of this clause.</p>
  </emu-clause>
</emu-clause>

<emu-clause id="definitions">
  <h1>Definitions</h1>
  <p>Terms can be defined using the `&lt;dfn>` element. Any uses of that term will be automatically linked to the clause containing the definition, or, if the `&lt;dfn>` element has an `id`, to the `&lt;dfn>` itself. This can be suppressed with the <a href="#emu-not-ref">`emu-not-ref`</a> element.</p>
  <p>When the term starts with a lowercase English letter, usages of the term with the first letter capitalized will also link.</p>
  <p>Other variants of the term, such as plural forms, can be provided as a comma-seperated list in the `variants` attribute on the element.</p>

  <h2>Example</h2>
  <pre><code class="language-html">
  &lt;p>A &lt;dfn id="swordfish" variants="swordfishes,broadbill,broadbills,Xiphias gladius">swordfish&lt;/dfn> is a large fish characterized by a long, pointed bill.&lt;/p>
  &lt;p>The Latin name for swordfishes, &lt;em>Xiphias gladius&lt;/em>, comes from the Greek word "ŒæŒØœÜŒøœÇ" (xiphos, "sword") and from the Latin word "gladius" ("sword").&lt;/p>
  </code></pre>

  <b>Result</b>
  <p>A <dfn id="swordfish" variants="swordfishes,Xiphias gladius">swordfish</dfn> is large fish characterized by a long, pointed bill.</p>
  <p>The Latin name for swordfishes, <em>Xiphias gladius</em>, comes from the Greek word "ŒæŒØœÜŒøœÇ" (xiphos, "sword") and from the Latin word "gladius" ("sword").</p>
</emu-clause>

<emu-clause id="effects">
  <h1>Effects</h1>
  <p>Abstract operations can be marked as having effects, which will propagate to callers. Calls to such operations are given the class <code>.e-effect-name</code>, subject to the following rules. When using `--mark-effects` the CSS includes styling for one effect, "user-code", which is off by default but can be togged by pressing "u".</p>

  <h2>Annotating effects</h2>
  <p>Effects can be added within an algorithm using an &lt;emu-meta> tag:</p>
  <pre><code class="language-html">1. Return ? &lt;emu-meta effects="user-code">_O_.[[Get]]&lt;/emu-meta>(_P_, _O_).</code></pre>

  <p>The same tag also allows you to suppress effects from an AO invocation:</p>
  <pre><code class="language-html">1. Set _buffer_ to ? &lt;emu-meta suppress-effects="user-code">AOWhichNormallyHasEffects()&lt;/emu-meta>.</code></pre>

  <p>Effects do not normally propagate to callsites prefixed with <code>!</code>. Such sites must be manually marked with an &lt;emu-meta> tag.</p>

  <p>When it is not possible to mark a particular part of an algorithm step as having effects (for example, when an AO is not defined with algorithm steps), the entire AO can be marked as having effects by adding to its <a href="#emu-clause-structured-headers">structured header</a> a &lt;dl>effects&lt;dl> entry whose corresponding &lt;dd> contains a comma-seperated list of effects:</p>
  <pre><code class="language-html">&lt;dl class="header">&lt;dt>effects&lt;/dt>&lt;dd>user-code&lt;/dd>&lt;/dl></code></pre>

  <p>When an algorithm step or its substeps have effects, but those effects should not imply the containing algorithm has the same effects, propagation may be prevented using a <pre><code>[fence-effects="user-code"]</code></pre> marker at the begining of the step. This rule is automatically applied to steps which define abstract closures.</p>

  <h2>Example</h2>
  <pre><code class="language-html">
    &lt;emu-clause id="sec-effect" type="abstract operation">
      &lt;h1>Effect ()&lt;/h1>
      &lt;dl class="header">&lt;/dl>
      &lt;emu-alg>
        1. &lt;emu-meta effects="user-code">Call user code.&lt;/emu-meta>
      &lt;/emu-alg>
    &lt;/emu-clause>

    &lt;emu-clause id="sec-transitive-effect" type="abstract operation">
      &lt;h1>TransitiveEffect ()&lt;/h1>
      &lt;dl class="header">&lt;/dl>
      &lt;emu-alg>
        1. Perform Effect().
      &lt;/emu-alg>
    &lt;/emu-clause>
  </code></pre>

  <b>Result (press "u" to toggle visible annotations)</b>
  <div class="result">
    <emu-clause id="sec-effect" type="abstract operation">
      <h1>Effect ()</h1>
      <dl class="header"></dl>
      <emu-alg>
        1. <emu-meta effects="user-code">Call user code.</emu-meta>
      </emu-alg>
    </emu-clause>

    <emu-clause id="sec-transitive-effect" type="abstract operation">
      <h1>TransitiveEffect ()</h1>
      <dl class="header"></dl>
      <emu-alg>
        1. Perform Effect().
      </emu-alg>
    </emu-clause>
  </div>
</emu-clause>

<emu-clause id="emu-alg" aoid="EmuAlg">
  <h1>emu-alg</h1>
  <p>Algorithm steps. Should not contain any HTML. The node's textContent is parsed as an Ecmarkdown document. Additionally, calls to abstract operations inside algorithm steps are automatically linked to their definitions by first checking for any clauses or algorithms with the appropriate "aoid" in the current spec, and afterwards checking any linked <a href="#emu-biblio">bibliography files</a>.</p>

  <h2>Example</h2>
  <emu-note>The emu-alg clause has an aoid of "EmuAlg".</emu-note>
  <h3>Element</h3>
  <pre><code class="language-html">
&lt;emu-alg aoid="EmuAlgExample">
  1. Let _clauseAbstractOp_ be the result of calling EmuAlg().
  1. Step 2.
    1. Let _recurse_ be the result of calling EmuAlgExample(*true*).
    1. Return the result of evaluating this |NonTerminalProduction|.
&lt;/emu-alg>
  </code></pre>
  <h3>Result</h3>
  <emu-alg aoid="EmuAlgExample">
    1. Let _clauseAbstractOp_ be the result of calling EmuAlg().
    1. Step 2.
      1. Let _recurse_ be the result of calling EmuAlgExample(*true*).
      1. Return the result of evaluating this |NonTerminalProduction|.
  </emu-alg>

  <h2>Replacement algorithms</h2>
  <p>Algorithms may be specified to replace a labeled step, in which case the algorithm will adopt the numbering of that step. For example:</p>

  <h3>Element</h3>
  <pre><code class="language-html">
    &lt;emu-alg>
      1. Step.
      1. Step 2.
        1. [id="step-replace-me"] Replaced.
          1. Substep.
    &lt;/emu-alg>
    &lt;p>The following is an alernative definition of step &lt;emu-xref href="#step-replace-me">&lt;/emu-xref>.&lt;/p>
    &lt;emu-alg replaces-step="replace-me">
      1. Replacement.
        1. Substep.
    &lt;/emu-alg>
  </code></pre>
  <h3>Result</h3>
  <emu-alg>
    1. Step.
    1. Step 2.
      1. [id="step-replace-me"] Replaced.
        1. Substep.
  </emu-alg>
  <p>The following is an alernative definition of step <emu-xref href="#step-replace-me"></emu-xref>.</p>
  <emu-alg replaces-step="step-replace-me">
    1. Replacement.
      1. Substep.
  </emu-alg>
</emu-clause>

<emu-clause id="emu-eqn">
  <h1>emu-eqn</h1>
  <p>An equation, similar to those found in ES6 <a href="https://tc39.es/ecma262/#sec-year-number">Year Number</a>.</p>

  <h2>Attributes</h2>
  <p><b>aoid:</b> Required: the abstract operation id that this equation defines.</p>
  <p><b>id:</b> Optional id. If present, links will go directly to the eqn definition. Otherwise, links go to the parent clause.</p>
</emu-clause>
<emu-clause id="emu-note">
  <h1>emu-note</h1>
  <p>Non-normative explanatory text. Comes in two flavors - regular notes and Editor's notes. Regular notes are intended for the implementers and end users of this specification. Editor's notes are notes to and from the Editors and will generally be removed prior to a specification being finalized and ratified.</p>

  <h2>Attributes</h2>
  <p><b>type:</b> The type of note, either blank or "editor".</p>

  <h2>Example</h2>
  <p>For authentication only, servers and clients MUST support SASL Salted Challenge Response Authentication Mechanism [SCRAM].</p>
  <emu-note>But we know you won't.</emu-note>
  <emu-note type=editor>This joke brought to you by RFC6919.</emu-note>
</emu-clause>

<emu-clause id="emu-xref">
  <h1>emu-xref</h1>
  <p>Cross-reference another clause, production, note, example, abstract operation, or labeled step. If the text content of this element is empty, a suitable default is used. The `title` attribute controls this default - when present, clauses are referred to using their title rather than number. This also applies to examples which are indexed first by their containing clause and then their example number.</p>
  <p>Cross-references to an id check for clauses, productions, examples, and steps in this order. For each type, the local document is consulted before looking for external sources.</p>

  <h2>Attributes</h2>
  <p><b>href:</b> Optional: URL of the target clause, production, or example to cross-reference.</p>
  <p><b>title:</b> Optional: If present, xref will be filled in with the referenced clause's title. Otherwise, the clause's section number is used.</p>
  <p><b>aoid:</b> Optional: aoid of an abstract operation to reference.</p>

  <p>One of aoid or href must be specified.</p>

  <h2>Example</h2>
  <pre><code class="language-html">
    &lt;p>The clause element is specified in &lt;emu-xref href="#emu-clause">&lt;/emu-xref>.&lt;/p>
    &lt;p>See &lt;emu-xref href="#emu-note" title>&lt;/emu-xref> for information on the emu-note element.&lt;/p>
    &lt;p>The &lt;emu-xref href="#emu-biblio">biblio element&lt;/emu-xref> supports xref to external specs.&lt;/p>
    &lt;p>&lt;emu-xref aoid="Get">&lt;/emu-xref> is an abstract operation from ES6&lt;/p>
    &lt;p>&lt;emu-alg>1. [id="step-label-example"] Example labeled step.&lt;/emu-alg>&lt;/p>
    &lt;p>You can reference step &lt;emu-xref href="#step-label-example">&lt;/emu-xref> like this&lt;/p>
  </code></pre>

  <b>Result</b>
  <p>The clause element is specified in <emu-xref href="#emu-clause"></emu-xref>.</p>
  <p>See <emu-xref href="#emu-note" title></emu-xref> for information on the emu-note element.</p>
  <p>The <emu-xref href="#emu-biblio">biblio element</emu-xref> will eventually support xref to external specs.</p>
  <p><emu-xref aoid="Get"></emu-xref> is an abstract operation from ES6</p>
  <p><emu-alg>1. [id="step-label-example"] Example labeled step.</emu-alg></p>
  <p>You can reference step <emu-xref href="#step-label-example"></emu-xref> like this</p>
</emu-clause>

<emu-clause id="emu-not-ref" namespace="emu-not-ref">
  <h1>emu-not-ref</h1>
  <p>Suppresses automatic linking to definitions.</p>

  <h2>Example</h2>
  <pre><code class="language-html">
  &lt;div id="not-ref-section-1">
    &lt;p>An &lt;dfn>example&lt;/dfn> is used for illustrative purposes.&lt;/p>
  &lt;/div>
  &lt;div id="not-ref-section-2">
    &lt;p>When a word defined in another section (or algorithm step) is used, as in this example, it is normally automatically linked to the section containing the definition.&lt;/p>
    &lt;p>When such a word should not be automatically linked, for &lt;emu-not-ref>example&lt;/emu-not-ref> when using its colloquial definition, it can be wrapped with this tag to surpress the automatic linking.&lt;/p>
  &lt;/div>
  </code></pre>

  <b>Result</b>
  <div id="not-ref-section-1">
    <p>An <dfn>example</dfn> is used for illustrative purposes.</p>
  </div>
  <div id="not-ref-section-2">
    <p>When a word defined in another section (or algorithm step) is used, as in this example, it is normally automatically linked to the section containing the definition.</p>
    <p>When such a word should not be automatically linked, for <emu-not-ref>example</emu-not-ref> when using its colloquial definition, it can be wrapped with this tag to surpress the automatic linking.</p>
  </div>
</emu-clause>

<emu-clause id="emu-figure">
  <h1>emu-figure</h1>
  <p>Creates a figure that can be xrefed by ID using the `emu-xref` element. Add a caption using a child `emu-caption` element.</p>
  <h2>Attributes</h2>
  <p><b>informative:</b> Optional: If present, the figure is informative. Otherwise it is normative.</p>

  <h2>Example</h2>
  <pre><code class="language-html">
  &lt;emu-figure>
    &lt;emu-caption>Example figure&lt;emu-caption>
    [[insert some awesome graphic here, maybe something like figure 2]]
  &lt;/emu-figure>
  </code></pre>
  <emu-figure>
    <emu-caption>Example figure</emu-caption>
    [[insert some awesome graphic here, maybe something like figure 2]]
  </emu-figure>
</emu-clause>

<emu-clause id="emu-table">
  <h1>emu-table</h1>
  <p>Creates a table that can be xrefed by ID using the `emu-xref` element. Add a caption using a child `emu-caption` element.</p>
  <h2>Attributes</h2>
  <p><b>caption:</b> Optional: Caption for the example</p>
  <p><b>informative:</b> Optional: If present, the table is informative. Otherwise it is normative.</p>

  <h2>Example</h2>
  <pre><code class="language-html">
  &lt;emu-table>
    &lt;emu-caption>Example table&lt;emu-caption>
    &lt;table>
      &lt;tr>&lt;th>Column 1&lt;/th>&lt;th>Column 2&lt;/th>&lt;/tr>
      &lt;tr>&lt;td>Value&lt;/td>&lt;td>Value 2&lt;/td>&lt;/tr>
      &lt;tr>&lt;td>Value&lt;/td>&lt;td>Value 2&lt;/td>&lt;/tr>
      &lt;tr>&lt;td>Value&lt;/td>&lt;td>Value 2&lt;/td>&lt;/tr>
      &lt;tr>&lt;td>Value&lt;/td>&lt;td>Value 2&lt;/td>&lt;/tr>
    &lt;/table>
  &lt;/emu-table>
  </code></pre>
  <emu-table>
    <emu-caption>Example table</emu-caption>
    <table>
      <tr><th>Column 1</th><th>Column 2</th></tr>
      <tr><td>Value</td><td>Value 2</td></tr>
      <tr><td>Value</td><td>Value 2</td></tr>
      <tr><td>Value</td><td>Value 2</td></tr>
      <tr><td>Value</td><td>Value 2</td></tr>
    </table>
  </emu-table>
</emu-clause>

<emu-clause id="emu-example">
  <h1>emu-example</h1>
  <p>Creates an informative example. Examples are numbered based on how many are present in the example's containing clause. Can be xrefed by ID using `emu-xref`.</p>

  <h2>Attributes</h2>
  <p><b>caption:</b> Optional: Caption for the example</p>

  <h2>Example</h2>
  <pre><code class="language-html">
&lt;emu-example caption="Example Example">
  This is an example.
&lt;/emu-example>

&lt;emu-example caption="Another Example Example">
  This is also an example.
&lt;/emu-example>
  </code></pre>
  <emu-example caption="Example Example">
    This is an example.
  </emu-example>

  <emu-example caption="Another Example Example">
    This is also an example.
  </emu-example>
</emu-clause>
<emu-clause id="emu-biblio">
  <h1>emu-biblio</h1>
  <p>Links a bibliography file. The bibliography file is a JSON document containing URLs for referenced documents along with any algorithms they define.</p>

  <h2>Attributes</h2>
  <p><b>href:</b> Required: URL to the biblio file.</p>

  <h2>Example</h2>
  <b>biblio.json</b>
  <pre><code class="language-json">{
  "https://tc39.github.io/ecma262/": [
    {
      "type": "op",
      "id": "sec-returnifabrupt",
      "aoid": "ReturnIfAbrupt"
    },
    {
      "type": "op",
      "id": "sec-get-o-p",
      "aoid": "Get"
    }
  ]
}</code></pre>
  <b>spec.emu</b>
  <pre><code class="language-html">
&lt;emu-biblio href="./biblio.json">&lt;/emu-biblio>
&lt;emu-alg>
1. let _res_ be Get(_obj_, _key_).
1. ReturnIfAbrupt(_res_).
&lt;/emu-alg>
  </code></pre>

  <b>Result</b>
  <emu-alg>
    1. let _res_ be Get(_obj_, _key_).
    1. ReturnIfAbrupt(_res_).
  </emu-alg>
</emu-clause>

<emu-clause id="grammar">
  <h1>Specifying Grammar</h1>
  <p>There are two ways to specify grammar in Ecmarkup: using the <a href="#emu-production">emu-production</a> element and related elements, or by using the <a href="#emu-grammar">emu-grammar</a> element which allows specifying grammar using a plaintext format.</p>

  <h2>Examples</h2>
  <b>WhileStatement</b>
  <pre><code class="language-html">&lt;emu-production name="WhileStatement">
  &lt;emu-rhs>while ( &lt;emu-nt>Expression&lt;/emu-nt> ) &lt;emu-nt>Statement&lt;/emu-nt>&lt;/emu-rhs>
&lt;/emu-production></code></pre>

  <emu-production name="WhileStatement" primary>
    <emu-rhs>while ( <emu-nt>Expression</emu-nt> ) <emu-nt>Statement</emu-nt></emu-rhs>
  </emu-production>

  <b>ArgumentList</b>
  <pre><code class="language-html">&lt;emu-production name="ArgumentList">
  &lt;emu-rhs>&lt;emu-nt>AssignmentExpression&lt;/emu-nt>&lt;/emu-rhs>
  &lt;emu-rhs>&lt;emu-nt>ArgumentList&lt;/emu-nt> , &lt;emu-nt>AssignmentExpression&lt;/emu-nt>&lt;/emu-rhs>
&lt;/emu-production></code></pre>

  <emu-production name="ArgumentList" primary>
    <emu-rhs><emu-nt>AssignmentExpression</emu-nt></emu-rhs>

    <emu-rhs><emu-nt>ArgumentList</emu-nt> , <emu-nt>AssignmentExpression</emu-nt></emu-rhs>
  </emu-production>

  <b>IterationStatement</b>
  <pre><code class="language-html">&lt;emu-production name="IterationStatement">
  &lt;emu-rhs>for ( &lt;emu-nt>LexicalDeclaration&lt;/emu-nt> ; &lt;emu-nt optional>Expression&lt;/emu-nt> ;
  &lt;emu-nt optional>Expression&lt;/emu-nt> ) &lt;emu-nt>Statement&lt;/emu-nt>&lt;/emu-rhs>
&lt;/emu-production></code></pre>
  <emu-production name="IterationStatement" primary>
    <emu-rhs>for ( <emu-nt>LexicalDeclaration</emu-nt> ; <emu-nt optional>Expression</emu-nt> ;
    <emu-nt optional>Expression</emu-nt> ) <emu-nt>Statement</emu-nt></emu-rhs>
  </emu-production>

  <b>Identifier</b>
  <pre><code class="language-html">&lt;emu-production name="Identifier" type="lexical">
  &lt;emu-rhs>&lt;emu-nt>IdentifierName&lt;/emu-nt> &lt;emu-gmod>but not
  &lt;emu-nt>ReservedWord&lt;/emu-nt>&lt;/emu-gmod>&lt;/emu-rhs>
&lt;/emu-production></code></pre>
  <emu-production name="Identifier" type="lexical" primary>
    <emu-rhs><emu-nt>IdentifierName</emu-nt> <emu-gmod>but not
    <emu-nt>ReservedWord</emu-nt></emu-gmod></emu-rhs>
  </emu-production>

  <b>SourceCharacter</b>
  <pre><code class="language-html">&lt;emu-production name="SourceCharacter" type="lexical">
  &lt;emu-rhs>&lt;emu-gprose>any Unicode code point&lt;/emu-gprose>&lt;/emu-rhs>
&lt;/emu-production></code></pre>
  <emu-production name="SourceCharacter" type="lexical" primary>
    <emu-rhs><emu-gprose>any Unicode code point</emu-gprose></emu-rhs>
  </emu-production>

  <b>ExpressionStatement</b>
  <pre><code class="language-html">&lt;emu-production name="ExpressionStatement" params="Yield">
  &lt;emu-rhs>
    &lt;emu-gann>lookahead ‚àâ {
      &lt;emu-t>{&lt;/emu-t>,
      &lt;emu-t>function&lt;/emu-t>,
      &lt;emu-t>class&lt;/emu-t>,
      &lt;emu-t>let [&lt;/emu-t>
    }&lt;/emu-gann>
  &lt;/emu-rhs>
&lt;/emu-production></code></pre>
  <emu-production name="ExpressionStatement" params="Yield" primary>
    <emu-rhs>
      <emu-gann>lookahead ‚àâ {
        <emu-t>{</emu-t>,
        <emu-t>function</emu-t>,
        <emu-t>class</emu-t>,
        <emu-t>let [</emu-t>
      }</emu-gann>
    </emu-rhs>
  </emu-production>

  <b>DecimalDigit</b>
  <pre><code class="language-html">&lt;emu-production name="DecimalDigit" type="lexical" oneof>
  &lt;emu-rhs>0 1 2 3 4 5 6 7 8 9&lt;/emu-rhs>
&lt;/emu-production></code></pre>
  <emu-production name="DecimalDigit" type="lexical" oneof primary>
    <emu-rhs>0 1 2 3 4 5 6 7 8 9</emu-rhs>
  </emu-production>

  <b>StatementList</b>
  <pre><code class="language-html">&lt;emu-production name="StatementList" params="Return, In">
  &lt;emu-rhs constraints="~Return">&lt;emu-nt>ReturnStatement&lt;/emu-nt>&lt;/emu-rhs>
  &lt;emu-rhs>&lt;emu-nt>ExpressionStatement&lt;/emu-nt>&lt;/emu-rhs>
&lt;/emu-production></code></pre>
  <emu-production name="StatementList" params="Return, In" primary>
    <emu-rhs constraints="~Return"><emu-nt>ReturnStatement</emu-nt></emu-rhs>
    <emu-rhs><emu-nt>ExpressionStatement</emu-nt></emu-rhs>
  </emu-production>

  <emu-clause id="emu-grammar">
    <h1>emu-grammar</h1>
    <p>Text inside emu-grammar elements is parsed using <a href="https://github.com/rbuckton/grammarkdown">Grammarkdown</a>. The syntax is essentially identical to the notational conventions in ECMAScript (minus formatting). See the <a href="https://github.com/rbuckton/grammarkdown">Grammarkdown readme</a>.</p>
    <p>Grammar will be displayed as an "inline" element flowing with text unless it is the immediate child of an emu-clause-like element.</p>
    <h2>Attributes</h2>
    <p><b>collapsed:</b> If present, production is displayed in collapsed format with LHS and RHS on the same line.</p>
    <p><b>collapsed:</b> If present, production is displayed in collapsed format with LHS and RHS on the same line.</p>
  </emu-clause>

  <emu-clause id="emu-production">
    <h1>emu-production</h1>
    <p>This is the top level element that contains all grammar productions. Each production MUST include at least one right-hand side (see <a href="#emu-rhs">emu-rhs</a>).</p>
    <p>The production will be displayed as an "inline" element flowing with text unless it is the immediate child of an emu-clause-like element or if its containing emu-grammar element is an immediate child of an emu-clause-like element.</p>
    <h2>Attributes</h2>
    <h2>Attributes</h2>
    <p><b>Name:</b> Required. Name of the production (i.e. the non-terminal on the LHS).</p>
    <p><b>Params:</b> Parameters for this production. Multiple parameters separated by commas.</p>
    <p><b>Type:</b> Type of production, either "lexical" or "regexp". Default is blank (normal).</p>
    <p><b>oneof:</b> If present, production is a one-of production. See DecimalDigit example above.</p>
    <p><b>collapsed:</b> If present, production is displayed in collapsed format with LHS and RHS on the same line.</p>
  </emu-clause>

  <emu-clause id="emu-rhs">
    <h1>emu-rhs</h1>
    <p>Describes one right-hand-side alternative of a production. Text nodes inside of an rhs are split on each space and turned into terminals. For example, <pre>&lt;emu-rhs>a b c&lt;/emu-rhs></pre> is semantically equivalent to <pre>&lt;emu-rhs>&lt;emu-t>a&lt;/emu-t> &lt;emu-t>b&lt;/emu-t> &lt;emu-t>c&lt;/emu-t>&lt;/emu-rhs></pre></p>
    <h2>Attributes</h2>
    <p><b>constraints:</b> any constraints for this RHS. Multiple constraints separated by commas. See StatementList example above.</p>
    <p><b>a:</b> Optional alternative id used to reference a particular RHS via `emu-prodref`. Must be unique for all `emu-rhs` elements inside an emu-production. Example might be <pre>&lt;emu-rhs a='1'></pre>.</p>
  </emu-clause>

  <emu-clause id="emu-nt">
    <h1>emu-nt</h1>
    <p>Non-terminal. Alpha characters only.</p>
    <h2>Attributes</h2>
    <p><b>Params:</b> Parameters for this production. Multiple parameters separated by commas.</p>
    <p><b>oneof:</b> If present, production is a one-of production (see DecimalDigit example above).</p>
  </emu-clause>

  <emu-clause id="emu-t">
    <h1>emu-t</h1>
    <p>Terminal. No attributes available. Mostly don't need to create these elements manually as <a href="#emu-rhs">they are created automatically inside emu-rhs elements</a>.</p>
  </emu-clause>

  <emu-clause id="emu-gmod">
    <h1>emu-gmod</h1>

    <p>Contains well-known modifiers to a right-hand side of a production. The only well-known modifier at present is the "but not" modifier. See the Identifier example above.</p>
  </emu-clause>

  <emu-clause id="emu-gann">
    <h1>emu-gann</h1>

    <p>Contains well-known annotations to to a right-hand side of a production. The only well-known modifiers at present are "lookahead" and "empty". See the ExpressionStatement example above. Any text inside a gann element is wrapped in square brackets.</p>
  </emu-clause>

  <emu-clause id="emu-gprose">
    <h1>emu-gprose</h1>
    <p>Contains any prose text that describes a production. See SourceCharacter example above.</p>
  </emu-clause>

  <emu-clause id="emu-prodref">
    <h1>emu-prodref</h1>
    <p>References a production defined elsewhere in the document. Ecmarkup will insert either the entire production or a particular RHS depending on attributes.</p>

    <h2>Attributes</h2>
    <p><b>name:</b> Required. Name of the production to reference.</p>
    <p><b>a:</b> Optional. If present, specified a particular alternative ID to reference.</p>
  </emu-clause>
</emu-clause>

<emu-clause id="imports">
  <h1>Imports</h1>
  <p>HTML Imports are treated specially in an ecmarkup document. Every import is inlined into its parent document at the location of the import tag. This is useful for breaking your spec document up into many smaller pieces.</p>
</emu-clause>

<emu-clause id="css">
  <h1>Other Styles &amp; Conventions</h1>
  <emu-clause id="oldids">
      <h1>Old IDs</h1>
      <p>Old IDs for any element can be stored as a comma-separated list inside an <b>oldids</b> attribute, allowing links using them to continue working as expected.</p>
  </emu-clause>
  <emu-clause id="ins-del">
    <h1>ins &amp; del</h1>
    <p>The `ins` and `del` HTML tags can be used to mark insertions and deletions respectively. When adding or removing block content (such as entire list items, paragrpahs, clauses, grammar RHSes, etc.), use a class of "block".</p>

    <h2>Inline Example:</h2>
    <pre><code class="language-html">ECMAScript &lt;del>6&lt;/del>&lt;ins>2015&lt;/ins> &lt;del>will be ratified&lt;/del>&lt;ins>was ratified&lt;/ins> in June, 2015.</code></pre>
    <h3>Result:</h3>
    <p>ECMAScript <del>6</del><ins>2015</ins> <del>will be ratified</del><ins>was ratified</ins> in June, 2015.</p>

    <h2>Block Example:</h2>
    <pre><code class="language-html">
&lt;p>|HoistableDeclaration| is modified as follows:&lt;/p>
&lt;emu-production name="HoistableDeclaration">
  &lt;emu-rhs>&lt;emu-nt>FunctionDeclaration&lt;/emu-nt>&lt;/emu-rhs>
  &lt;emu-rhs>&lt;emu-nt>GeneratorDeclaration&lt;/emu-nt>&lt;/emu-rhs>
  &lt;ins class="block">&lt;emu-rhs>&lt;emu-nt>AsyncFunctionDeclaration&lt;/emu-nt>&lt;/emu-rhs>&lt;/ins>
&lt;/emu-production>
    </code></pre>
    <h3>Result:</h3>
    <p>|HoistableDeclaration| is modified as follows:</p>
    <emu-production name="HoistableDeclaration">
      <emu-rhs><emu-nt>FunctionDeclaration</emu-nt></emu-rhs>
      <emu-rhs><emu-nt>GeneratorDeclaration</emu-nt></emu-rhs>
      <ins class="block"><emu-rhs><emu-nt>AsyncFunctionDeclaration</emu-nt></emu-rhs></ins>
    </emu-production>
  </emu-clause>
  <emu-clause id="pre-code">
    <h1>Code Listings</h1>
    <p>Create a code listing using `&lt;pre>&lt;code>`. The `code` element takes a class of `javascript`, `html`, or any other language provided by <a href="https://highlightjs.org/">highlightjs</a>. Ecmarkup will trim any leading blank lines and also normalize the indentation based on the indentation of the first line.</p>
  </emu-clause>
</emu-clause>
